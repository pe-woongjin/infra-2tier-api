<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Services - infra-2tier-services</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Services";
    var mkdocs_page_input_path = "services.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> infra-2tier-services</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Info</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../architecture/">Architecture</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../directory/">Directory</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../modules/">Modules</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Services</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#1-api">1. API</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#11-security-group">1.1 Security Group</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#12-target-group">1.2 Target Group</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#13-launch-template">1.3 Launch Template</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#14-autoscaling-group">1.4 Autoscaling Group</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#15-code-deploy">1.5 Code Deploy</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#2-ui">2. UI</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#21-security-group">2.1 Security Group</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#22-target-group">2.2 Target Group</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#23-launch-template">2.3 Launch Template</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#24-autoscaling-group">2.4 Autoscaling Group</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#25-code-deploy">2.5 Code Deploy</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">infra-2tier-services</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Services</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="infra-2tier-services-services">infra-2tier-services Services</h2>
<hr />
<p>services는 <code>api</code>, <code>ui</code>로 구성되어 있습니다.</p>
<hr />
<h4 id="1-api">1. API</h4>
<blockquote>
<p>app-backend-springboot application을 위한 인프라입니다.<br />
application을 위한 resource는 다음과 같습니다.
</p>
</blockquote>
<h5 id="11-security-group">1.1 Security Group</h5>
<pre><code class="console">resource &quot;aws_security_group&quot; &quot;api-sg&quot; {            -- Security Group resource 설정
    vpc_id  = var.vpc_id                            -- VPC 설정

    ingress {                                       -- Inbound rule 설정
        ...
    }

    egress {                                        -- Outbound rule 설정
        ...
    }
}
</code></pre>

<blockquote></blockquote>
<h5 id="12-target-group">1.2 Target Group</h5>
<pre><code class="console">resource &quot;aws_alb_target_group&quot; &quot;api-a-tg8080&quot; {    -- Target Group resource 설정
    port        = 8080                              -- 포트 설정
    protocol    = &quot;HTTP&quot;                            -- protocol 설정
    target_type = &quot;instance&quot;                        -- 타겟 그룹의 타입 선택(instance, ip, lambda)
    vpc_id      = var.vpc_id                        -- VPC 설정

    health_check {
        healthy_threshold   = 2                     -- 연속적 상태 검사 성공 횟수(2-10)
        unhealthy_threshold = 2                     -- 연속적 상태 검사 실패 횟수(2~10)
        interval            = 10                    -- 상태 검사 사이의 대략적인 시간
        macher              = &quot;200&quot;                 -- 응답 성공 HTTP 코드(200~299)
        path                = &quot;/health&quot;             -- 상태 검사의 대상 경로
    }
    ...
}
</code></pre>

<blockquote></blockquote>
<h5 id="13-launch-template">1.3 Launch Template</h5>
<pre><code class="console">resource &quot;aws_launch_template&quot; &quot;api-lt&quot; {           -- Launch Template resource 설정
    image_id                = var.api_lt.id         -- 기구축된 image id
    instance_type           = var.api_lt.key_name   -- 기구축된 image의 타입
    key_name                = var.api_lt.type       -- 해당 인스턴스를 사용하기 위한 key name
    vpc_security_group_ids  = [ id ]                -- 관련 security group ids

    iam_instance_profile { } -- The IAM Instance Profile to launch the instance with
    ...
}
</code></pre>

<blockquote></blockquote>
<h5 id="14-autoscaling-group">1.4 Autoscaling Group</h5>
<pre><code class="console">resource &quot;aws_autoscaling_group&quot; &quot;api-a-asg&quot; {      -- Autoscaling Group resource 설정
    launch_template { }                             -- 기구축된 Launch Template 정보

    vpc_zone_identifier = var.api-sn-id             -- 기구축된 subnet ids
    target_group_arns   = [ arn ]                   -- 기구축된 target group arns(autoscaling 대상)
    health_check_type   = &quot;ELB&quot;                     -- health check 방법 설정(EC2, ELB)                     

    min_size            = var.api_lt.min_size       -- instance의 최소 갯수
    max_size            = var.api_lt.max_size       -- instance의 최대 갯수
    ...
}
</code></pre>

<blockquote></blockquote>
<h5 id="15-code-deploy">1.5 Code Deploy</h5>
<pre><code class="console">data &quot;aws_iam_role&quot; &quot;codedeploy_role&quot; {     -- IAM role 설정
    name = var.cd_role_name                 -- 기구축된 role name 설정
}

resource &quot;aws_codedeploy_deployment_group&quot; &quot;api-cd-group-a&quot; {   -- Codedeploy Deployment Group resource 설정
    deployment_config_name  = &quot;CodeDeployDefault.AllAtOnce&quot;     -- 배포 설정
    service_role_arn        = codedeploy-role.arn               -- 배포 role
    autoscaling_groups      = [ id ]                            -- 배포할 Autoscaling Group
    deployment_style { }                                        -- 배포 스타일(in-place, blue/green) 
    ...
}
</code></pre>

<blockquote></blockquote>
<h4 id="2-ui">2. UI</h4>
<blockquote>
<p>app-frontend-vue application을 위한 인프라입니다.
application을 위한 resource는 다음과 같습니다.
</p>
</blockquote>
<h5 id="21-security-group">2.1 Security Group</h5>
<pre><code class="console">resource &quot;aws_security_group&quot; &quot;ui-sg&quot; {             -- Security Group resource 설정
    vpc_id  = var.vpc_id                            -- VPC 설정

    ingress {                                       -- Inbound rule 설정
        ...
    }

    egress {                                        -- Outbound rule 설정
        ...
    }
}
</code></pre>

<blockquote></blockquote>
<h5 id="22-target-group">2.2 Target Group</h5>
<pre><code class="console">resource &quot;aws_alb_target_group&quot; &quot;ui-a-tg80&quot; {       -- Target Group resource 설정
    port        = 80                                -- 포트 설정
    protocol    = &quot;HTTP&quot;                            -- protocol 설정
    target_type = &quot;instance&quot;                        -- 타겟 그룹의 타입 선택(instance, ip, lambda)
    vpc_id      = var.vpc_id                        -- VPC 설정

    health_check {
        healthy_threshold   = 2                     -- 연속적 상태 검사 성공 횟수(2-10)
        unhealthy_threshold = 2                     -- 연속적 상태 검사 실패 횟수(2~10)
        interval            = 10                    -- 상태 검사 사이의 대략적인 시간
        macher              = &quot;200&quot;                 -- 응답 성공 HTTP 코드(200~299)
        path                = &quot;/&quot;                   -- 상태 검사의 대상 경로
    }
    ...
}
</code></pre>

<blockquote></blockquote>
<h5 id="23-launch-template">2.3 Launch Template</h5>
<pre><code class="console">resource &quot;aws_launch_template&quot; &quot;ui-lt&quot; {            -- Launch Template resource 설정
    image_id                = var.ui.id             -- 기구축된 image id
    instance_type           = var.ui.key_name       -- 기구축된 image의 타입
    key_name                = var.ui.type           -- 해당 인스턴스를 사용하기 위한 key name
    vpc_security_group_ids  = [ id ]                -- 관련 security group ids

    iam_instance_profile { } -- The IAM Instance Profile to launch the instance with
    ...
}
</code></pre>

<blockquote></blockquote>
<h5 id="24-autoscaling-group">2.4 Autoscaling Group</h5>
<pre><code class="console">resource &quot;aws_autoscaling_group&quot; &quot;ui-a-asg&quot; {       -- Autoscaling Group resource 설정
    launch_template { }                             -- 기구축된 Launch Template 정보

    vpc_zone_identifier = var.ui-sn-id              -- 기구축된 subnet ids
    target_group_arns   = [ arn ]                   -- 기구축된 target group arns(autoscaling 대상)
    health_check_type   = &quot;ELB&quot;                     -- health check 방법 설정(EC2, ELB)                     

    min_size            = var.ui_lt.min_size        -- instance의 최소 갯수
    max_size            = var.ui_lt.max_size        -- instance의 최대 갯수
    ...
}
</code></pre>

<blockquote></blockquote>
<h5 id="25-code-deploy">2.5 Code Deploy</h5>
<pre><code class="console">data &quot;aws_iam_role&quot; &quot;codedeploy_role&quot; {     -- IAM role 설정
    name = var.cd_role_name                 -- 기구축된 role name 설정
}

resource &quot;aws_codedeploy_deployment_group&quot; &quot;ui-cd-group-a&quot; {    -- Codedeploy Deployment Group resource 설정
    deployment_config_name  = &quot;CodeDeployDefault.AllAtOnce&quot;     -- 배포 설정
    service_role_arn        = codedeploy-role.arn               -- 배포 role
    autoscaling_groups      = [ id ]                            -- 배포할 Autoscaling Group
    deployment_style { }                                        -- 배포 스타일(in-place, blue/green) 
    ...
}
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../modules/" class="btn btn-neutral" title="Modules"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../modules/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
